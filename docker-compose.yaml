version: '3.8'

services:
  wasm:
    build: .
    image: acrcredibil.azurecr.io/demo/wasmgrid
    platform: linux/amd64
    environment:
      - RUST_LOG=debug
    ports:
      - 8080:8080
    volumes:
      # pre-compiled WASM file (using examples/keyvalue)
      # - ./keyvalue.bin:/app.wasm
      # uncompiled WASM file
      - ./target/wasm32-wasip2/release/keyvalue.wasm:/app.wasm
    command: ["/app/wasmgrid", "run", "--compile", "/app.wasm"]